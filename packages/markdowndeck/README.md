# MarkdownDeck

[![Python Version][python-shield]][python-url]
[![PyPI Version][pypi-shield]][pypi-url]
[![License][license-shield]][license-url]
[![Build Status][build-shield]][build-url]

**Transform your Markdown into polished Google Slides presentations with programmatic control, intelligent layout, and AI-friendliness.**

MarkdownDeck is a powerful Python library designed to seamlessly bridge the gap between content generation (especially by Large Language Models) and the creation of structured, visually appealing Google Slides presentations. It converts a specialized Markdown dialect, augmented with intuitive layout directives, into Google Slides, expertly handling the complexities of API interactions and dynamic layout calculations.

## Why MarkdownDeck? The Unparalleled Solution for Programmatic Slide Generation

Generating presentations through direct API calls can be a daunting task, especially for automated agents or LLMs. Crafting the verbose, deeply nested, and perfectly validated JSON required by APIs like Google Slides presents significant challenges:

- **Overwhelming Complexity for LLMs & Agents:** Managing object IDs, intricate styling objects, precise coordinates, element relationships, and ensuring valid request sequences for numerous slide elements is exceptionally difficult for LLMs to perform reliably and accurately. Direct JSON generation is often error-prone and leads to fragile integrations.
- **Debugging Nightmares:** Faulty API JSON generated by an LLM is notoriously hard to debug. Markdown, being human-readable and simpler, makes troubleshooting content and structure far more manageable.
- **Context Window Inefficiency:** Large JSON payloads required for comprehensive slide creation can rapidly consume an LLM's context window, limiting its ability to process other critical information or generate extensive content.
- **Lack of Alternatives:** Currently, there are no comparable open-source solutions that offer such a high-level, Markdown-first approach to programmatic Google Slides generation with sophisticated layout control.

**MarkdownDeck is engineered to overcome these hurdles, establishing itself as the best-in-class solution.** It provides a robust abstraction layer that empowers LLMs, AI agents, and developers to define presentation structure, content, and layout using a simple, intuitive Markdown-based syntax. MarkdownDeck then shoulders the heavy lifting:

- **Intuitive Parsing and Interpretation:** Comprehensively understanding the Markdown structure, semantic meaning, and custom layout directives.
- **Intelligent, Dynamic Layout Management:** Automatically calculating element positions and sizes, adeptly handling content overflow across slides, and managing complex multi-column and section-based layouts with automatic space distribution.
- **Precise API Request Generation:** Translating the high-level Markdown representation into the exact, validated Google Slides API call sequences.

This unique approach delivers significant advantages:

- **Simplicity & Natural Interaction for AI:** LLMs can "think" and generate content in terms of natural slide structures (titles, sections, columns, lists, images) using Markdown, a format they excel at.
- **Enhanced Maintainability:** Changes or intricacies in the Google Slides API are abstracted away and managed within MarkdownDeck, shielding AI agent logic and reducing maintenance overhead.
- **Robust Decoupling:** The AI's core task of content generation is cleanly decoupled from the specifics of API interaction, leading to more resilient and adaptable systems.
- **Superior Testability:** MarkdownDeck itself is a well-defined, rigorously tested utility with clear inputs (Markdown) and outputs (API requests or presentations), ensuring reliability.

MarkdownDeck makes what was previously "completely impossible" for LLMs – reliably creating well-structured and styled presentations via API – not just possible, but efficient and straightforward.

## Key Features

MarkdownDeck is packed with features to make presentation generation powerful and flexible:

- **Intuitive Markdown-to-Slides:** Convert an enhanced Markdown dialect directly into Google Slides presentations.
- **Sophisticated Composable Layouts:** Define slides with multiple vertical and horizontal sections for complex and professional-looking arrangements.
- **Granular Layout Directives:** Precisely control section and element `width`, `height`, horizontal `align` (left, center, right, justify), vertical `valign` (top, middle, bottom), `background` (color or image), `padding`, text `color`, `fontsize`, `font-family`, `line-spacing`, `border` styling, and more using simple `[directive=value]` commands.
- **Intelligent Space Distribution:** Automatic and proportional calculation of dimensions for sections and elements that do not have explicit sizes defined.
- **Rich Content Element Support:**
  - Headings (H1-H6 mapped to titles, subtitles, or styled text)
  - Paragraphs with detailed inline formatting
  - Bulleted and Ordered Lists (including deeply nested lists)
  - GitHub Flavored Markdown Tables
  - Images with alt text
  - Fenced Code Blocks (with language specification for syntax highlighting hints in generated requests)
  - Blockquotes
  - Inline Formatting: **Bold**, _italic_, ~~strikethrough~~, `` `inline code` ``, [links](url).
- **Presentation Metadata:** Easily add speaker notes (``) and consistent footers (`@@@ Footer content`) to slides.
- **Customizable Slide Backgrounds:** Set solid colors (hex or named) or background images for individual slides using the `[background=...]` directive at the slide level.
- **Theme Integration:** Apply existing Google Slides themes to your presentation by providing a `theme_id`.
- **Automated Overflow Handling:** Intelligently moves content that exceeds slide boundaries to new, subsequent "continuation" slides, preserving content flow.
- **Flexible API Abstraction:**
  - `create_presentation()`: High-level function to directly create a presentation (handles parsing, layout, and API calls).
  - `markdown_to_requests()`: Generates the Google Slides API request bodies without executing them, allowing for integration into custom API call workflows.
- **Comprehensive Authentication:** Supports various Google OAuth methods, including service accounts and user credentials (via environment variables or token files).
- **Command-Line Interface (CLI):** Convert Markdown files to presentations directly from the terminal, ideal for scripting and quick generation.
- **Core Arclio MCP GSuite Component:** Powers the `create_presentation_from_markdown` tool within the Arclio MCP GSuite package, enabling AI agents to autonomously generate presentations.
- **Robustly Tested:** Includes an extensive test suite with over 300 tests covering unit, integration, and functional aspects, ensuring high reliability.

## Installation

MarkdownDeck requires Python 3.10 or higher.

```bash
pip install markdowndeck
```

To install from source (e.g., for development within the `arclio-mcp-tooling` monorepo):

```bash
# Ensure you are in the root of the arclio-mcp-tooling monorepo
# (Refer to the monorepo's README and CONTRIBUTING.md for full setup)
make install-editable PKGS="markdowndeck"
```

## MarkdownDeck Format

Define your presentation structure and content using standard Markdown, enhanced with special separators and layout directives.

### Slide Structure

- **`===` (Slide Separator):** Use three or more equals signs on a line by themselves to denote the end of one slide and the beginning of the next.
- **`---` (Vertical Section Separator):** Use three or more hyphens on a line by themselves to split the content of a slide into vertical sections (stacked one above the other).
- **`\***` (Horizontal Section Separator):\** Use three or more asterisks on a line by themselves to split the content *within\* a vertical section into horizontal sections (columns, arranged side-by-side).
- **`@@@` (Footer Separator):** Content below three or more '@' symbols on a line by themselves will be treated as the slide's footer.
- **`# Slide Title` (H1 for Slide Title):** The first H1 heading on a slide is typically treated as the slide's main title. Subsequent H1 or H2 headings can be used as subtitles or section titles within the content flow.
- **`` (Speaker Notes):** Add speaker notes using an HTML comment block. These notes will be associated with the slide they appear on.

### Layout Directives

Directives are placed at the beginning of a section's content (before any visible Markdown) or at the very beginning of a slide (for slide-level directives like background) and are enclosed in square brackets (`[]`). Multiple directives can be chained: `[directive1=value1][directive2=value2]`.

**Common Section & Element Directives:**

- `[width=<value>]`: Sets the width of a section or element.
  - Fraction (relative to available space in parent): `[width=1/2]`
  - Percentage: `[width=75%]`
  - Absolute (in points, less common for sections, useful for fixed-size elements if needed): `[width=300]`
- `[height=<value>]`: Sets the height of a section or element.
  - Fraction (relative to available space in parent): `[height=1/3]`
  - Percentage: `[height=60%]`
  - Absolute (in points): `[height=200]`
- `[align=<value>]`: Horizontal alignment of content _within_ the section or for a text element.
  - Values: `left` (default), `center`, `right`, `justify`.
- `[valign=<value>]`: Vertical alignment of content _within_ a section or for text elements.
  - Values: `top` (default), `middle`, `bottom`.
- `[padding=<value>]`: Inner padding for a section or text box element (in points, e.g., `[padding=10]`).
- `[color=<hex_or_theme_color_name>]`: Default text color for elements within the section (e.g., `[color=#333333]`, `[color=ACCENT1]`).
- `[fontsize=<points>]`: Default font size for text elements (e.g., `[fontsize=18]`).
- `[font-family=<name>]`: Default font family for text elements (e.g., `[font-family=Arial]`).
- `[line-spacing=<multiplier>]`: Sets line spacing for paragraphs (e.g., `[line-spacing=1.5]` for 1.5x spacing).
- `[para-spacing-before=<points>]`: Space before paragraphs.
- `[para-spacing-after=<points>]`: Space after paragraphs.
- `[indent-start=<points>]`: Indentation for the start of paragraphs.
- `[indent-first-line=<points>]`: Indentation for the first line of paragraphs.
- `[border=<spec>]`: Adds a border to text boxes or table elements.
  - Example: `[border=1pt solid #FF0000]`, `[border=2px dashed blue]`
- `[border-position=<position>]`: For tables, specifies which borders to apply (e.g., `ALL`, `OUTER`, `INNER`).
- `[cell-align=<value>]`: For tables, sets default horizontal/vertical alignment for cells.
- `[cell-background=<color>]`: For tables, sets cell background color.
- `[cell-range=<r1,c1:r2,c2>]`: For tables, specifies a cell range for `cell-align` or `cell-background`.

**Slide-Level Directives (Place at the very top of a slide's content, before any title or other content):**

- `[background=<value>]`: Sets the background for the entire slide.
  - Color (hex): `[background=#f0f0f0]`
  - Color (named, e.g., `ACCENT1` if theme-defined, or standard CSS names like `lightblue`): `[background=lightblue]`
  - Image URL: `[background=url(http://example.com/bg.png)]`

**Example:**

```markdown
[background=url([https://example.com/global_slide_bg.jpg](https://example.com/global_slide_bg.jpg))]

# Monthly Review - March

[height=1/3][background=#eeeeee][padding=10]

## Key Achievements

- Launched Project Phoenix ahead of schedule.
- Exceeded Q1 revenue targets by 15%.
- Customer satisfaction score increased to 92%.

---

[height=2/3]

### Detailed Breakdown

[width=1/2][padding=15][border=1pt solid #cccccc]

#### Sales Performance

[fontsize=12][color=#555555]

- North America: +20%
- Europe: +12%
  - Germany: +15% (Strong performance in DACH)
  - France: +8%
- Asia: +18% (Emerging markets growth)

---

[width=1/2][background=url(images/chart.png)][valign=middle][align=center]

@@@
Confidential | © 2025 Arclio Inc. | Page %p
```

## Usage

### Python API

```python
from markdowndeck import create_presentation, markdown_to_requests, get_themes
# Assuming Google OAuth credentials are set up (see Authentication section)

# Example Markdown
markdown_text = """
# My First Slide
[background=#FFF8DC]
This is content for my first slide.

* Bullet point 1
* Item with **bold** and *italic*.

===

# My Second Slide
[width=1/2]
## Left Column
Some text here.
---
[width=1/2]
## Right Column
![An example image](https://via.placeholder.com/300x150)
@@@
Slide Footer Example
"""

try:
    # Create presentation directly
    result = create_presentation(
        markdown=markdown_text,
        title="My Awesome Presentation",
        # theme_id="YOUR_GOOGLE_SLIDES_THEME_ID" # Optional
    )
    print(f"Presentation created: {result.get('presentationUrl')}")
    print(f"Presentation ID: {result.get('presentationId')}")

    # Generate API requests without executing them
    requests_payload = markdown_to_requests(
        markdown=markdown_text,
        title="My Request-Only Presentation"
    )
    print(f"\nTitle for API: {requests_payload['title']}")
    print(f"Number of slide batches: {len(requests_payload['slide_batches'])}")

    # List available (stubbed) themes
    # themes = get_themes()
    # print("\nAvailable Themes (stubbed list):")
    # for theme in themes:
    #     print(f"- {theme['name']} (ID: {theme['id']})")

except Exception as e:
    print(f"An error occurred: {e}")
    # For more detailed error information, consider logging:
    # import logging
    # logging.exception("Error during MarkdownDeck operation")
```

### Command-Line Interface (CLI)

Ensure your Google credentials are set up for the CLI (see Authentication).

```bash
# Convert a markdown file to a Google Slides presentation
markdowndeck create path/to/your/presentation.md --title "My CLI Presentation"

# Read markdown from stdin
cat path/to/your/presentation.md | markdowndeck create - --title "Stdin Presentation"

# Specify a Google Slides theme
markdowndeck create presentation.md --theme YOUR_THEME_ID

# Save presentation details (ID, URL) to a JSON file
markdowndeck create presentation.md -o output_details.json

# List available themes (note: this is a basic static list provided by MarkdownDeck)
markdowndeck themes

# Enable verbose logging for more details
markdowndeck -v create presentation.md
```

## Architecture Overview

MarkdownDeck employs a modular pipeline to transform Markdown into Google Slides:

1.  **Input**: Specially formatted Markdown text adhering to the MarkdownDeck dialect.
2.  **Parsing (`markdowndeck.parser`)**: This stage deconstructs the Markdown:
    - **`SlideExtractor`**: Divides the raw Markdown into segments, each representing a slide, using `===` as the primary delimiter. It also pre-processes each segment to identify top-level slide attributes like speaker notes (``), footers (`@@@`), and slide-level background directives (`[background=...]`).
    - **`SectionParser`**: For each slide's content, this parser further divides it into a hierarchy of `Section` objects based on `---` (for vertical stacking) and `***` (for horizontal columns within a vertical section) separators. This builds a tree-like layout structure for the slide. It utilizes a `ContentSplitter` to robustly handle these separations while preserving the integrity of code blocks.
    - **`DirectiveParser`**: Examines the beginning of each `Section`'s content for layout directives (e.g., `[width=1/2][align=center]`). It parses these directives, validates them against known types, and converts their values into structured data (e.g., "1/2" to `0.5`, "#FF0000" to a color object).
    - **`ContentParser`**: Takes each `Section` (now aware of its layout directives) and its Markdown content. It uses the `markdown-it-py` library to tokenize the Markdown into a stream of tokens. These tokens are then dispatched to specialized **Formatters**.
    - **Formatters (`markdowndeck.parser.content.formatters`)**: A suite of classes (`TextFormatter`, `ListFormatter`, `CodeFormatter`, `ImageFormatter`, `TableFormatter`), each designed to handle specific types of Markdown tokens (e.g., `fence` for code blocks, `bullet_list_open` for lists, `heading_open` for headings). They interpret these tokens and their content.
    - **`ElementFactory`**: Used by the Formatters, this factory class is responsible for constructing the actual `Element` model instances (e.g., `TextElement`, `ImageElement`, `ListElement`) from the token data and any applicable directives. It also meticulously extracts inline formatting (bold, italic, links, etc.) into `TextFormat` objects associated with `TextElement`s.
3.  **Intermediate Representation (`markdowndeck.models`)**: The parsing pipeline culminates in a structured, in-memory representation of the presentation:
    - `Deck`: The top-level object representing the entire presentation, containing a list of `Slide` objects, a title, and an optional theme ID.
    - `Slide`: Represents a single slide, holding its `object_id`, layout hints, speaker notes, background details, a list of top-level `Element` objects, and a list of `Section` objects.
    - `Section`: Defines a layout region within a slide, containing its own Markdown content (which `ContentParser` processes into elements for that section), parsed `directives`, a unique `id`, and potentially a list of `subsections` (if it's a "row" type for horizontal layout).
    - `Element` (and its subclasses: `TextElement`, `ImageElement`, `ListElement`, `CodeElement`, `TableElement`): These dataclasses represent individual content pieces (like a paragraph, an image, or a list) and store their content, type, `object_id`, and any applied `directives`. `TextElement`s also store detailed `formatting` information.
4.  **Layout Management (`markdowndeck.layout`)**: This stage calculates the visual arrangement of elements:
    - **`LayoutManager`**: Orchestrates the positioning process for each slide. It decides whether to use zone-based or section-based layout.
    - **`PositionCalculator`**: This is the core layout engine. It iterates through the `Slide`'s `Section` tree and the `Element`s within them. It interprets layout directives (`width`, `height`, `align`, `valign`, `padding`, etc.) to determine the precise (x, y) position and (width, height) size for every section and element. It intelligently handles both explicitly defined dimensions and distributes space proportionally for sections/elements without specified sizes. It relies on the `Metrics` module for content-aware height estimations.
    - **`Metrics` (`markdowndeck.layout.metrics`)**: A crucial set of heuristic functions that estimate the rendered height of various element types (text paragraphs, lists, code blocks, tables) based on their actual content, inline formatting, and the available width. This allows for more accurate space allocation.
    - **`OverflowHandler`**: After initial positions are calculated, this component checks if any content extends beyond the usable boundaries of a slide's body zone. If overflow is detected, it intelligently moves the overflowing elements (and related elements that should stay together) to newly created "continuation" slides, ensuring all content is presented.
5.  **API Request Generation (`markdowndeck.api`)**:
    - **`ApiRequestGenerator`**: Takes the fully processed `Deck` object – where every slide, section, and element has its content, styling, size, and position determined – and translates this rich intermediate representation into a sequence of JSON objects. These JSON objects are meticulously structured to conform to the Google Slides API `batchUpdate` request format. It uses various **Request Builders** (`SlideRequestBuilder`, `TextRequestBuilder`, etc.) to construct the specific API requests for creating slides, shapes, text, tables, images, and applying styling.
6.  **API Interaction (`markdowndeck.api`)**:
    - **`ApiClient`**: (Primarily used by the `create_presentation` function). This client handles the actual communication with the Google Slides API. It takes care of authentication, packaging the generated requests into batches, and executing these `batchUpdate` calls to create and populate the Google Slides presentation. It also handles API-level error responses and retries.

This layered and modular architecture ensures that each part of the Markdown-to-Slides conversion process is well-defined, testable, and maintainable, allowing for robust and flexible presentation generation.

## Supported Markdown Features

MarkdownDeck supports a wide range of standard Markdown features, which are then mapped to Google Slides elements:

- **Headers**: `# H1` through `###### H6` (H1 often becomes slide title, H2 as subtitle, others as styled text).
- **Paragraphs**: Standard text blocks.
- **Inline Formatting**:
  - `**Bold text**` or `__Bold text__`
  - `*Italic text*` or `_Italic text_`
  - `~~Strikethrough text~~`
  - `` `Inline code` ``
  - `[Link text](http://example.com)`
- **Lists**:
  - Unordered lists (`*`, `-`, `+`)
  - Ordered lists (`1.`, `2.`)
  - Nested lists are fully supported.
- **Tables**: GitHub Flavored Markdown style tables.
- **Images**: `![Alt text](image_url "Optional title")`
- **Code Blocks**: Fenced code blocks (using ``` or ~~~) with language specification for syntax highlighting hints (e.g., \`\`\`python).
- **Blockquotes**: `> Quoted text` (rendered as styled text elements).
- **Thematic Breaks / Horizontal Rules**: While `---` and `***` are primarily used as section separators, other thematic break syntaxes like `___` are treated as standard Markdown.
- **Speaker Notes**: ``
- **Custom Layout Directives**: As detailed in the "MarkdownDeck Format" section, providing extensive control over layout and styling.

## Authentication

MarkdownDeck offers several flexible methods for authenticating with Google APIs, primarily managed by the `ApiClient` and helper functions in `markdowndeck.api.auth`:

1.  **Pass `Credentials` Object**: Directly provide a `google.oauth2.credentials.Credentials` object to the `create_presentation()` function's `credentials` parameter. This offers the most explicit control.
2.  **Pass Google API `Service` Object**: If your application already has an initialized Google API service resource (e.g., from `googleapiclient.discovery.build`), you can pass this to `create_presentation()` via the `service` parameter, bypassing MarkdownDeck's internal service creation.
3.  **Environment Variables (for User OAuth Flow)**: MarkdownDeck can automatically pick up credentials if the following environment variables are set. These are typically obtained from your Google Cloud project's OAuth 2.0 client ID JSON file after an initial authorization.
    - `SLIDES_CLIENT_ID`
    - `SLIDES_CLIENT_SECRET`
    - `SLIDES_REFRESH_TOKEN`
4.  **Service Account Credentials**: Set the `GOOGLE_APPLICATION_CREDENTIALS` environment variable to the absolute path of your service account JSON key file. MarkdownDeck will use these credentials to authenticate, requesting the necessary scopes (primarily `https://www.googleapis.com/auth/presentations`). This is often preferred for server-to-server interactions.
5.  **Local Token Files (for CLI & Default User Flow)**: If no explicit credentials or service account details are provided via the above methods, MarkdownDeck (and its CLI) will attempt to load credentials from:
    - `~/.markdowndeck/token.json`: Stores user credentials from a previous successful OAuth flow.
    - `~/.markdowndeck/credentials.json`: Your OAuth 2.0 client ID JSON file, which can be used to initiate a new OAuth flow if `token.json` is missing or invalid.

The `get_credentials()` utility function in `markdowndeck.api.auth` (and used by the CLI) checks these methods in a specific order (environment variables, token file, then attempts OAuth flow if client secrets are found).

## Current Limitations

While MarkdownDeck is powerful, some limitations currently exist:

- **Single Large Element Overflow**: While content overflow across slides is handled for sequences of elements, a _single element_ that is intrinsically too large to fit on one slide (e.g., an extremely long, non-wrappable code block, or an image with dimensions exceeding slide height) will be placed on a new slide but may still visually overflow. The system does not currently split the content _within_ such individual elements (like breaking a table into multiple tables or truncating text within a single text box to fit).
- **No Reverse Transformation**: MarkdownDeck currently supports conversion from Markdown _to_ Google Slides only. It does not provide functionality to convert existing Google Slides presentations _back_ into the MarkdownDeck Markdown format.
- **Layout Heuristics & Custom Fonts**: Element height calculation, especially for text, relies on heuristics. While generally effective for standard fonts and content, highly customized fonts (not directly controllable via MarkdownDeck directives) or extremely unusual content structures might lead to minor layout inaccuracies. These would typically require small adjustments in the source Markdown.
- **Dynamic Theme Discovery**: The `get_themes()` function currently provides a static, predefined list of common Google Slides theme IDs. The Google Slides API does not offer a direct endpoint to dynamically list all themes available to a user. However, _applying_ any valid theme ID via the `create_presentation` function's `theme_id` parameter is fully supported.

## Future Development

MarkdownDeck has a strong foundation with significant potential for future enhancements. These are categorized by estimated effort:

### Low-Hanging Fruit / Easier to Implement:

- **Enhanced Slide Operations via Markdown Directives/API:**
  - **Insert Slide at Index:** Allow specifying `[slide_index=N]` to insert the generated slide at a particular position in an _existing_ presentation.
  - **Update Existing Slide:** Introduce a mechanism (e.g., `[slide_id=EXISTING_SLIDE_ID][update_mode=replace|append]`) to target and modify an existing slide's content.
  - **Delete Slide:** A function or directive to delete a slide by its ID or index in an existing presentation.
  - These would involve extending `ApiClient` and `ApiRequestGenerator` to support these new request types, leveraging existing element parsing and layout logic.
- **More Granular List Styling Directives:**
  - `[list-style-type=disc|circle|square|decimal|lower-roman|etc.]` to control bullet/numbering styles more directly.
  - `[list-indent=<points>]` for custom indentation levels.
- **Additional Text Styling Directives:**
  - `[text-transform=uppercase|lowercase|capitalize]`
  - `[letter-spacing=<points>]`

### Moderate Effort:

- **Advanced Overflow Handling for Specific Elements:**
  - Implement strategies to intelligently split content _within_ large elements like long tables (across multiple slides, repeating headers), deeply nested lists, or very long code blocks. This would require more sophisticated content chunking logic.
- **More Sophisticated Shape Styling:**
  - Directives for shape fill (gradients, patterns beyond solid color/image), line styles (thickness, end caps, join types for borders), shadows.
- **Support for Basic Charts/Diagrams via Markdown:**
  - Define a simple Markdown syntax (e.g., using code blocks with a specific language like `mermaid` or a custom chart syntax) that MarkdownDeck can parse and translate into basic Google Slides chart objects or grouped shapes.

### Significant Improvement / More Work:

- **Reverse Transformation (Google Slides to MarkdownDeck Format):**
  - Develop a parser for the Google Slides API's presentation JSON format to convert existing presentations back into MarkdownDeck's dialect. This is a complex task due to the richness and variability of Slides content.
- **Support for Other Presentation Platforms (e.g., Microsoft PowerPoint):**
  - This would require a new set of API clients, request generators, and potentially adapting the layout engine for different slide metrics and API capabilities. This is a major undertaking but would significantly broaden the library's applicability.
- **Extending Beyond Slides:**
  - Adapting the core parsing and layout engine to generate other structured document formats (e.g., Google Docs, PDFs) from a similar Markdown dialect.
- **Direct Integration with Google Drive for Images/Content:**
  - Allowing directives like `[image=drive:FILE_ID]` to directly embed images from Google Drive, handling permissions and API calls.
- **Dynamic Theme Discovery (API Permitting):**
  - If Google ever provides an API to list user-available themes, integrate this into `get_themes()`.

## Development & Contribution

MarkdownDeck is an independently installable Python package. However, its primary development and testing occur within the `arclio-mcp-tooling` monorepo.

### Monorepo Context

- **Shared Tooling**: Tests, linting (Ruff), formatting, and build tools (UV, Hatch) are configured and run from the monorepo root.
- **Cross-Package Dependencies**: MarkdownDeck is a dependency of other packages within the monorepo, such as `arclio-mcp-gsuite`.
- **Full Experience**: For a complete development and testing experience, contributors will typically need to work within the context of the cloned `arclio-mcp-tooling` monorepo.

Please refer to the `CONTRIBUTING.md` file in the root of the `arclio-mcp-tooling` monorepo for detailed guidelines on setting up the development environment, running tests, linting, and the contribution process.

### Running Tests for MarkdownDeck

From the root of the `arclio-mcp-tooling` monorepo:

```bash
# Run all tests for markdowndeck (unit and integration)
make test markdowndeck

# Run only unit tests for markdowndeck
make test-unit markdowndeck

# Run integration tests for markdowndeck (requires API credentials)
# Ensure RUN_INTEGRATION_TESTS=1 is set in your environment or .env
make test-integration markdowndeck
```

## License

MarkdownDeck is licensed under the MIT License. See the `LICENSE` file in the `packages/markdowndeck` directory (or the root of the `arclio-mcp-tooling` monorepo if applicable) for details.

---

_MarkdownDeck: Effortless Presentation Generation for Developers and AI._

[python-shield]: [https://img.shields.io/badge/python-3.10+-blue.svg](https://img.shields.io/badge/python-3.10+-blue.svg)
[python-url]: [https://www.python.org/downloads/release/python-3100/](https://www.python.org/downloads/release/python-3100/)
[pypi-shield]: [https://img.shields.io/pypi/v/markdowndeck.svg](https://img.shields.io/pypi/v/markdowndeck.svg)
[pypi-url]: [https://pypi.org/project/markdowndeck/](https://pypi.org/project/markdowndeck/)
[license-shield]: [https://img.shields.io/badge/License-MIT-yellow.svg](https://img.shields.io/badge/License-MIT-yellow.svg)
[license-url]: [https://opensource.org/licenses/MIT](https://opensource.org/licenses/MIT)
[build-shield]: [https://img.shields.io/github/actions/workflow/status/arclio/arclio-mcp-tooling/ci.yml?branch=main&label=build&logo=github](https://img.shields.io/github/actions/workflow/status/arclio/arclio-mcp-tooling/ci.yml?branch=main&label=build&logo=github)
[build-url]: [https://github.com/arclio/arclio-mcp-tooling/actions/workflows/ci.yml](https://github.com/arclio/arclio-mcp-tooling/actions/workflows/ci.yml)
