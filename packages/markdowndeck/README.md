# MarkdownDeck

[![Python Version][python-shield]][python-url]
[![PyPI Version][pypi-shield]][pypi-url]
[![License][license-shield]][license-url]
[![Build Status][build-shield]][build-url]

<div align="center">

**Transform Markdown into professional Google Slides presentations with complete control over layout and styling.**

</div>

## What is MarkdownDeck?

MarkdownDeck is a Python library that converts specially-formatted Markdown into Google Slides presentations. Unlike traditional presentation tools that rely on themes and templates, MarkdownDeck treats each slide as a blank canvas, giving you precise control over every element's position, size, and appearance.

### Why MarkdownDeck?

Creating presentations programmatically through the Google Slides API is notoriously complex:

- **API Complexity**: The Google Slides API requires verbose JSON with exact coordinates, carefully sequenced requests, and proper object relationships
- **Layout Challenges**: Calculating text wrapping, element positioning, and content distribution across slides requires sophisticated spatial algorithms
- **Content Overflow**: Managing how content flows from one slide to the next while maintaining visual consistency is a significant engineering challenge

MarkdownDeck solves these problems by providing an intuitive Markdown-based syntax while handling all the underlying complexity automatically.

## Key Features

### üéØ **Blank Canvas Philosophy**

- Every slide starts as a clean slate with no inherited theme properties
- Complete control over positioning, sizing, and styling
- Predictable, explicit behavior with no hidden defaults

### üìê **Advanced Layout System**

- Explicit container-based layouts using fenced blocks
- Support for multi-column designs and nested sections
- Automatic content overflow handling with intelligent slide continuation
- Precise spacing control with padding, margins, and gaps

### üìù **Rich Content Support**

- Formatted text with headings, bold, italic, and inline code
- Bulleted and ordered lists with full nesting
- Tables with row-level styling directives
- Images with required dimensions for predictable layouts
- Code blocks with syntax highlighting
- Speaker notes and slide footers

### üé® **Comprehensive Styling**

- Size elements using points, percentages, or fractions
- Control alignment both horizontally and vertically
- Apply backgrounds, colors, borders, and opacity
- Customize typography with fonts, sizes, and line spacing
- All styling is explicit through inline directives

## Installation

```bash
pip install markdowndeck
```

## Quick Start

```python
from markdowndeck import create_presentation

# Define your presentation content
markdown_content = """
# Welcome to MarkdownDeck
## Creating Beautiful Presentations with Markdown

:::section [padding=40][background=#f0f0f0]
    :::row [gap=30]
        :::column [width=60%]
            ### Why MarkdownDeck?

            - Write presentations in Markdown
            - Get pixel-perfect control
            - Automatic overflow handling
            - No hidden formatting surprises
        :::
        :::column [width=40%][align=center]
            ![logo](https://example.com/logo.png) [width=200][height=150]
        :::
    :::
:::

<!-- notes: Emphasize the simplicity of the Markdown syntax -->

@@@
Built with MarkdownDeck | 2025
"""

# Create the presentation
result = create_presentation(
    markdown=markdown_content,
    title="My First MarkdownDeck Presentation"
)

print(f"Presentation created: {result['presentationUrl']}")
```

## Live Demo

See a sample presentation generated by MarkdownDeck:
[**Quarterly Business Review - Live Demo**](https://docs.google.com/presentation/d/1aBcDeFgHiJkLmNoPqRsTuVwXyZ_12345AbCdEfGhIjK/edit?usp=sharing)

## Core Concepts

### 1. Fenced Block Layout System

MarkdownDeck uses explicit fenced blocks to create layouts:

```markdown
:::section [directives]
Content goes here
:::

:::row [gap=20]
:::column [width=50%]
Left column
:::
:::column [width=50%]
Right column
:::
:::
```

### 2. Inline Directives

All styling and layout control happens through directives placed on the same line as the element:

```markdown
# Blue Title [color=blue][fontsize=36]

![image](url.jpg) [width=400][height=300]

:::section [background=#e0e0e0][padding=20]
Content with gray background
:::
```

### 3. Explicit Dimensions

Every image must have both width and height specified:

```markdown
![chart](data.png) [width=500][height=400]
```

### 4. Table Styling

Tables use a dedicated final column for row directives. The directive is placed on the row it styles.

```markdown
| Product | Price | Stock | [background=#333][color=white] |
| ------- | ----- | ----- | ------------------------------ |
| Widget  | $10   | 50    |                                |
| Gadget  | $25   | 0     | [background=#ffcccc]           |
```

## Authentication

MarkdownDeck supports multiple authentication methods:

1. **Service Account** (Recommended for automation):

   ```bash
   export GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json
   ```

2. **OAuth with Environment Variables**:

   ```bash
   export SLIDES_CLIENT_ID=your-client-id
   export SLIDES_CLIENT_SECRET=your-client-secret
   export SLIDES_REFRESH_TOKEN=your-refresh-token
   ```

3. **Interactive OAuth Flow**:
   Place your credentials at `~/.markdowndeck/credentials.json`

## Complete Example

Here's a more comprehensive example showing various features:

```python
from markdowndeck import create_presentation

presentation_markdown = """
# Quarterly Business Review
## Q4 2024 Results

[color=#666][fontsize=14]
Executive Summary - Confidential

:::section [padding=30]
    ### Agenda

    :::section [background=#f8f8f8][padding=20][margin-top=20]
        1. Financial Performance
        2. Key Achievements
        3. Market Analysis
        4. Q1 2025 Outlook
    :::
:::

===

# Financial Highlights

:::row [gap=40]
    :::column [width=40%]
        ### Revenue Growth

        **$12.5M** Total Revenue
        **+23%** Year-over-year

        :::section [margin-top=30]
            Key drivers:
            - New product launch
            - International expansion
            - Partner channel growth
        :::
    :::
    :::column [width=60%][align=center]
        ![revenue-chart](https://example.com/chart.png) [width=400][height=300]
    :::
:::

===

# Regional Performance

:::section [padding=20]
    | Region        | Q3 2024  | Q4 2024  | Growth | [background=#1a73e8][color=white][bold] |
    |---------------|----------|----------|--------|-----------------------------------------|
    | North America | $5.2M    | $6.1M    | +17%   |                                         |
    | Europe        | $3.1M    | $3.8M    | +23%   |                                         |
    | APAC          | $2.4M    | $2.6M    | +8%    | [background=#fff3cd]                    |
    | **Total**     | **$10.7M** | **$12.5M** | **+17%** | [background=#e8f4f8]                    |
:::

<!-- notes: APAC growth was impacted by seasonal factors -->

@@@
Q4 2024 Business Review - Internal Use Only
"""

result = create_presentation(
    markdown=presentation_markdown,
    title="Q4 2024 Business Review"
)
```

## Advanced Features

### Automatic Overflow Handling

When content exceeds slide boundaries, MarkdownDeck automatically creates continuation slides:

- Text is intelligently split at paragraph or sentence boundaries
- Tables continue with headers repeated
- Lists maintain proper numbering across slides
- Images that don't fit are moved entirely to the next slide

### Base Styles

Apply default styling to all elements on a slide:

```markdown
[color=#333][fontsize=14]
All text on this slide inherits these styles

# This title is also affected [color=blue]

But can override specific properties
```

### Nested Layouts

Create complex layouts with multiple levels of nesting:

```markdown
:::section [padding=20]
:::row [gap=20]
:::column [width=30%] ### Sidebar
Navigation or filters
:::
:::column [width=70%] ### Main Content

            :::row [gap=10][margin-top=20]
                :::column [width=50%]
                    Card 1
                :::
                :::column [width=50%]
                    Card 2
                :::
            :::
        :::
    :::

:::
```

## Best Practices

1. **Use Indentation**: While not required, indenting nested blocks improves readability
2. **Specify All Dimensions**: Always provide both width and height for images
3. **Test Overflow**: Check how your content behaves when it exceeds slide boundaries
4. **Be Explicit**: MarkdownDeck has no default spacing‚Äîspecify all padding and margins
5. **Plan Layouts First**: Design your section structure before adding content

## Limitations

- No support for animations or transitions
- No video or audio embedding
- No built-in chart generation (use image URLs)
- All images must be publicly accessible via HTTPS
- No escape sequences for special characters

## API Reference

### Basic Functions

```python
# Create a presentation and upload to Google Slides
result = create_presentation(
    markdown="# Your content here",
    title="Presentation Title"
)

# Generate API requests without executing them
requests = markdown_to_requests(
    markdown="# Your content here"
)
```

## Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

## License

MarkdownDeck is licensed under the MIT License. See [LICENSE](LICENSE) for details.

---

[python-shield]: https://img.shields.io/badge/python-3.10+-blue.svg
[python-url]: https://www.python.org/downloads/
[pypi-shield]: https://img.shields.io/pypi/v/markdowndeck.svg
[pypi-url]: https://pypi.org/project/markdowndeck/
[license-shield]: https://img.shields.io/badge/License-MIT-yellow.svg
[license-url]: https://opensource.org/licenses/MIT
[build-shield]: https://img.shields.io/github/actions/workflow/status/arclio/markdowndeck/ci.yml?branch=main
[build-url]: https://github.com/arclio/markdowndeck/actions
